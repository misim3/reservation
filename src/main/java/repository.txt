레포지토리는 데이터를 저장하고 검색하는 클래스이다
일반적으로 dao클래스와 유사한 기능을 수행하지만,
도메인 모델과 더 밀접한 관련이 있다.
public class AccountRepository {
    private final EntityManager entityManager;

    public AccountRepository(EntityManager entityManager) {
        this.entityManager = entityManager;
    }

    public void save(AccountDTO accountDTO) {
        Account account = new Account(accountDTO.getAccountNumber(), accountDTO.getBalance());
        entityManager.persist(account);
    }

    public AccountDTO findById(Long id) {
        Account account = entityManager.find(Account.class, id);
        if (account == null) {
            return null;
        }
        return new AccountDTO(account.getId(), account.getAccountNumber(), account.getBalance());
    }

    public List<AccountDTO> findAll() {
        List<Account> accounts = entityManager.createQuery("SELECT a FROM Account a", Account.class).getResultList();
        return accounts.stream()
                .map(account -> new AccountDTO(account.getId(), account.getAccountNumber(), account.getBalance()))
                .collect(Collectors.toList());
    }

    public void delete(Long id) {
        Account account = entityManager.find(Account.class, id);
        if (account != null) {
            entityManager.remove(account);
        }
    }

    public void update(AccountDTO accountDTO) {
        Account account = entityManager.find(Account.class, accountDTO.getId());
        if (account != null) {
            account.setAccountNumber(accountDTO.getAccountNumber());
            account.setBalance(accountDTO.getBalance());
            entityManager.merge(account);
        }
    }
}